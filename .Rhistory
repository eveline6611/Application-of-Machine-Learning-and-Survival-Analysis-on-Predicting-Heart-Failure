summary(model4)
model5<-lm( y ~ 锘縳1 + x2 + x4 + x5 + I(x6^6) + x8 + as.factor(x9) + x10 + x11 + x12 + x13,data=a)
summary(model5)
hist(y)
r1= model5 $residuals
hist(r1)
skewness(r1)
library(MASS)
b=boxcox(model5)
b
lambda=b$x
lik=b$y
I=which(lik==max(lik))
lambda=b$x[I]
lambda
model6<-lm( y^lambda ~ 锘縳1 + x2 + x4 + x5 + I(x6^6) + x8 + as.factor(x9) + x10 + x11 + x12 + x13,data=a)
summary(model6)
hist(y^lambda)
model1<-lm(y~.,data=a）summary(model1)
model1<-lm(y~.,data=a)
> summary(model1)
model1<-lm(y~.,data=a)summary(model1)
model1<-lm(y~.,data=a)
> summary(model1)
model1<-lm(y~.,data=a)
summary(model1)
锘縳1=x1
x1=锘縳1
model1<-lm(y~.,data=a)
summary(model1)
a=read.table(file.choose(),header=T)
a=read.csv(file.choose(),header=T)
model0<-lm(MEDV~CRIM+ZN+ INDUS+CHAS+NOX+RM+AGE+DIS+RAD+TAX+PTRATIO+B+LSTAT)
summary(model0)
model0<-lm(MEDV~CRIM+ZN+INDUS+CHAS+NOX+RM+AGE+DIS+RAD+TAX+PTRATIO+B+LSTAT)
summary(model0)
model0<-lm(MEDV~CRIM+ZN+ INDUS+CHAS+NOX+RM+AGE+DIS+RAD+TAX+PTRATIO+B+LSTAT)
summary(model0)
attach(a)
model0<-lm(MEDV~CRIM+ZN+ INDUS+CHAS+NOX+RM+AGE+DIS+RAD+TAX+PTRATIO+B+LSTAT)
summary(model0)
step(model0)
model1<-lm(MEDV ~ CRIM + ZN + CHAS + NOX + RM + DIS + RAD +TAX + PTRATIO + B + LSTAT)
summary(model1)
RAD=as.factor(RAD)
contrasts(RAD)
model2<-lm(MEDV ~ CRIM + ZN + CHAS + NOX + RM + DIS + RAD +TAX + PTRATIO + B + LSTAT)
summary(model2)
par(mfrow = c(2,2))
plot(model2)
library(MASS)
b=boxCox(model2)
par(mfrow = c(2,2))
plot(model2)
library(MASS)
b=boxCox(model2)
I=which(b$y==max(b$y))
b$x[I]
model3<-lm(MEDV^0.1414141~ CRIM + ZN + CHAS + NOX + I(RM^4) + DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model3)
model4<-lm(log(MEDV)~ CRIM + ZN + CHAS + NOX + I(RM^4) + DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model4)
library(car)
boxTidwell(y,x1)#0.3
boxTidwell(y,x6)#4
boxTidwell(y,x8)#-0.9
boxTidwell(y,x13)#-0.4
model3<-lm(MEDV^0.1414141~ CRIM + ZN + CHAS + NOX + (RM+ DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model3)
model3<-lm(MEDV^0.1414141~ CRIM + ZN + CHAS + NOX + (RM+ DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model3)
model3<-lm(MEDV^0.1414141~ CRIM + ZN + CHAS + NOX + RM+ DIS + RAD +TAX + PTRATIO + B +LSTAT)
model3
summary(model3)
summary(model3)
model4<-lm(log(MEDV)~ CRIM + ZN + CHAS + NOX + RM + DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model4)
vif(model0)
par(mfrow = c(4,4))
crPlots(model3)
model5<-lm(MEDV^0.1414141~ CRIM + ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model5)
model7<-lm(MEDV^0.1414141~ CRIM + ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +I(LSTAT^2)+I(LSTAT^3))
summary(model7)
outlierTest(model7,cutoff = Inf,n.max = 15)
model8<-lm(log(MEDV)~ CRIM + ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +I(LSTAT^2)+I(LSTAT^3))
summary(model8)
outlierTest(model8,cutoff = Inf,n.max = 15)
model10<-lm(log(MEDV)~ CRIM + ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +I(LSTAT^2)+I(LSTAT^3),data=d[-c(365,372,373,369,402,410,215,400,401,413,506),])
model10<-lm(log(MEDV)~ CRIM + ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +I(LSTAT^2)+I(LSTAT^3),data=a[-c(365,372,373,369,402,410,215,400,401,413,506),])
summary(model10)
#press of model0
Sum0<-summary(model0)
x<-model.matrix(model0)
press=sum((Sum0$residuals/(1-hat(x)))^2)
press
#test for model0
ncvTest(model0)
library(lmtest)
dwtest(model0)
#cr plot for model0
crPlots(model0)
residuals0<-resid(model0)
qqnorm(residuals0)
qqline(residuals0)
#residual plot
fit0=fitted(model0)
residuals0=resid(model0)
plot(fit0,residuals0)
abline(h=0)
#press of model0
Sum0<-summary(model0)
x<-model.matrix(model0)
press=sum((Sum0$residuals/(1-hat(x)))^2)
press
#test for model0
ncvTest(model0)
library(lmtest)
dwtest(model0)
#cr plot for model0
crPlots(model0)
residuals0<-resid(model0)
qqnorm(residuals0)
qqline(residuals0)
#residual plot
fit0=fitted(model0)
residuals0=resid(model0)
plot(fit0,residuals0)
abline(h=0)
Sum0<-summary(model0)
x<-model.matrix(model0)
press=sum((Sum0$residuals/(1-hat(x)))^2)
press
ncvTest(model0)
library(lmtest)
dwtest(model0)
crPlots(model0)
par(mfrow=c(1,1))
residuals0<-resid(model0)
qqnorm(residuals0)
qqline(residuals0)
crPlots(model0)
fit0=fitted(model0)
residuals0=resid(model0)
plot(fit0,residuals0)
abline(h=0)
Sum1<-summary(model1)
x<-model.matrix(model1)
press=sum((Sum1$residuals/(1-hat(x)))^2)
press
ncvTest(model1)
library(lmtest)
dwtest(model1)
par(mfrow=c(1,1))
residuals1<-resid(model1)
qqnorm(residuals1)
qqline(residuals1)
fit1=fitted(model1)
residuals1=resid(model1)
plot(fit1,residuals1)
abline(h=0)
crPlots(model1)
Sum2<-summary(model2)
x<-model.matrix(model2)
press=sum((Sum2$residuals/(1-hat(x)))^2)
press
ncvTest(model2)
library(lmtest)
dwtest(model2)
par(mfrow=c(1,1))
residuals2<-resid(model2)
qqnorm(residuals2)
qqline(residuals2)
fit2=fitted(model2)
residuals2=resid(model2)
plot(fit2,residuals2)
abline(h=0)
crPlots(model2)
model4.5<-lm(MEDV^0.6~ CRIM + ZN + CHAS + NOX + RM + DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model4.5)
summary(model4.5)
Sum3<-summary(model3)
x<-model.matrix(model3)
press=sum((Sum3$residuals/(1-hat(x)))^2)
press
ncvTest(model3)
library(lmtest)
dwtest(model3)
par(mfrow=c(1,1))
residuals3<-resid(model3)
qqnorm(residuals3)
qqline(residuals3)
fit3=fitted(model3)
residuals3=resid(model3)
plot(fit3,residuals3)
abline(h=0)
Sum4<-summary(model4)
x<-model.matrix(model4)
press=sum((Sum4$residuals/(1-hat(x)))^2)
press
ncvTest(model4)
library(lmtest)
dwtest(model4)
par(mfrow=c(1,1))
residuals4<-resid(model4)
qqnorm(residuals4)
qqline(residuals4)
fit4=fitted(model4)
residuals4=resid(model4)
plot(fit4,residuals4)
abline(h=0)
Sum4.5<-summary(model4.5)
x<-model.matrix(model4.5)
press=sum((Sum4.5$residuals/(1-hat(x)))^2)
press
ncvTest(model4.5)
library(lmtest)
dwtest(model4.5)
par(mfrow=c(1,1))
residuals4<-resid(model4.5)
qqnorm(residuals4.5)
qqline(residuals4.5)
fit4.5=fitted(model4.5)
residuals4.5=resid(model4.5)
plot(fit4.5,residuals4.5)
abline(h=0)
model7<-lm(MEDV^0.1414141~ I(CRIM^0.7) + ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +LSTAT
summary(model7)
outlierTest(model7,cutoff = Inf,n.max = 15)
model7<-lm(MEDV^0.1414141~ I(CRIM^0.7) + ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model7)
model8<-lm(log(MEDV)~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model8)
outlierTest(model8,cutoff = Inf,n.max = 15)
model9<-lm(MEDV^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO + B +LSTAT)
summary(model8)
outlierTest(model8,cutoff = Inf,n.max = 15)
> p<-rep(0,20)
> R<-rep(0,20)
> for(i in 1:20){ s<-seq(from=0,to=2,length=20); model<-lm(MEDV^s[i]~ CRIM + ZN + CHAS + NOX + RM+ DIS + RAD +TAX + PTRATIO + B +LSTAT,data=d);
+R[i]<-summary(model)$r.square;
+p[i]<-ncvTest(model)$p}
> choose<-rbind(p,R)
print(choose
> p<-rep(0,20)
> R<-rep(0,20)
> for(i in 1:20){ s<-seq(from=0,to=2,length=20); model<-lm(MEDV^s[i]~ CRIM + ZN + CHAS + NOX + RM+ DIS + RAD +TAX + PTRATIO + B +LSTAT,data=d);
+R[i]<-summary(model)$r.square;
+p[i]<-ncvTest(model)$p}
> choose<-rbind(p,R)
print(choose)
> p<-rep(0,20)
> R<-rep(0,20)
> for(i in 1:20){ s<-seq(from=0,to=2,length=20); model<-lm(MEDV^s[i]~ CRIM + ZN + CHAS + NOX + RM+ DIS + RAD +TAX + PTRATIO + B +LSTAT,data=d);
R[i]<-summary(model)$r.square;
p[i]<-ncvTest(model)$p}
> choose<-rbind(p,R)
print(choose)
p<-rep(0,20)
R<-rep(0,20)
for(i in 1:20){ s<-seq(from=0,to=2,length=20); model<-lm(MEDV^s[i]~ CRIM + ZN + CHAS + NOX + RM+ DIS + RAD +TAX + PTRATIO + B +LSTAT,data=d);
R[i]<-summary(model)$r.square;
p[i]<-ncvTest(model)$p}
choose<-rbind(p,R)
print(choose)
p<-rep(0,20)
R<-rep(0,20)
for(i in 1:20){ s<-seq(from=0,to=2,length=20); model<-lm(MEDV^s[i]~ CRIM + ZN + CHAS + NOX + RM+ DIS + RAD +TAX + PTRATIO + B +LSTAT,data=a);
R[i]<-summary(model)$r.square;
p[i]<-ncvTest(model)$p}
choose<-rbind(p,R)
print(choose)
model10<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT),data=d[-c(365,372,373,369,402,410,215,400,401,413,506),])
model10<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT),data=d[-c(365,372,373,369,402,410,215,400,401,413,506),])
par(mfrow=c(1,1))
residuals4.5<-resid(model4.5)
qqnorm(residuals4.5)
qqline(residuals4.5)
fit4.5=fitted(model4.5)
residuals4.5=resid(model4.5)
plot(fit4.5,residuals4.5)
abline(h=0)
model3
ncvTest(model4.5)
library(lmtest)
dwtest(model4.5)
crPlots(model9)
ncvTest(model9)
library(lmtest)
dwtest(model9)
#cr plot for model8
crPlots(model9)
model9
model10<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT),data=d[-c(365,372,373,369,402,410,215,400,401,413,506),])
model10<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX +PTRATIO+B+LSTAT),data=d[-c(365,372,373,369,402,410,215,400,401,413,506),])
RAD=as.factor(RAD)
model7<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT),data=d[-c(365,372,373,369,402,410,215,400,401,413,506),])
model7<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT)
summary(model7)
model7<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT),data=d[-c(365,372,373,369,402,410,215,400,401,413,506),])
model7<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT),data=d[-c(365,372,373,369,402,410,215,400,401,413,506),]
model7<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT,data=d[-c(365,372,373,369,402,410,215,400,401,413,506),])
model7<-lm((MEDV)^0.6~ I(CRIM^0.7)+ ZN + CHAS + NOX + I(RM^6) + DIS + RAD +TAX + PTRATIO+B+LSTAT,data=a[-c(365,372,373,369,402,410,215,400,401,413,506),])
summary(model7)
ncvTest(model7)
library(lmtest)
dwTest(model7)
dwtest(model7)
model9
library(class)
knn(train, test, cl, k, prob = FALSE)
a<-sample(1:150)
tdata<-iris[a[1:120],]
cdata<-iris[a[121:150],]
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3,prob=T)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3,prob=T)
a
cdata[，1:4]
tdata<-iris[a[1:120],]
cdata<-iris[a[121:150],]
tdata
cdata
View(cdata)
View(cdata)
install.packages('kknn')
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3,prob=T)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3,prob=T)
library(kknn)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3,prob=T)
library(car)
library(class)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3,prob=T)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3,prob=T)
library(class)
a<-sample(1:150)
tdata<-iris[a[1:120],]
cdata<-iris[a[121:150],]
cc<-knn(tdata[,1:4], cdata[，1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[,1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[,1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[,1:4], tdata[,5],k = 3,prob=T)
cc
library(class)
a<-sample(1:150)
tdata<-iris[a[1:120],]
cdata<-iris[a[121:150],]
cc<-knn(tdata[,1:4], cdata[,1:4], tdata[,5],k = 3)
cc<-knn(tdata[,1:4], cdata[,1:4], tdata[,5],k = 3,prob=T)
cc
install.packages('e1071')
library(class)
library(e1071)
a<-sample(1:150)
tdata<-iris[a[1:120],]
cdata<-iris[a[121:150],]
m<-naiveBayes(Species~., data=tdata)
pc<-predict(m, cdata)
m
pc
data=read.table("sweat_data.txt",header = F)
data=read.table(file.choose(),header = F)
x_ba=apply(data, 2, mean)
x_ba=round(matrix(x_ba),digits = 4)
s=cov(data)
s=round(matrix(s,ncol = 3),digits = 4)
s_inverse=round(solve(s),digits = 4)
library("forecast")
library("tseries")
library("fUnitRoots")
data = read.csv(file.choose())
MAEs = list()
for(i in 148:214){
road1 = subset(data,road_id == i)
train = subset(road1,day_id<=42)
test = subset(road1,day_id>42)
trainSpeed = train[,"speed"]
testSpeed = test[,"speed"]
#construct SARIMA model
tsSpeed = ts(trainSpeed,frequency = 144)
pdq = auto.arima(tsSpeed)
model = arima(tsSpeed,order=c(pdq$arma[1],pdq$arma[6],pdq$arma[2]),
seasonal=list(order = c(pdq$arma[3], pdq$arma[7], pdq$arma[4]),
period = pdq$arma[5]))
#forecast
res = forecast(model,h=dim(test)[1])
#evaluate
residual = abs(res$mean-testSpeed)
mae = mean(residual)
MAEs[[i]]=mae
}
View(MAEs)
View(MAEs)
library("survival")
data = read.csv(file.choose())
data("data", package = "JM")
install.packages("JM")
data("data", package = "JM")
data("peacedata", package = "JM")
data("data")
res.cox=coxph(Surv(time,death)~age+tx+sysbp+gender+hidiabet+hihypert,data=data)
res.cox=coxph(Surv(time,death)~age+tx+sysbp+gender+hidiabet+hihypert,data=data)
summary(res.cox)
res.cox=coxph(Surv(t2death,death)~age+tx+sysbp+gender+hidiabet+hihypert,data=data)
summary(res.cox)
df0=read.csv(file.choose(),header=T)
df=df0[,-1]
df[,20]=ifelse(df$Churn == "Yes", 1, 0)
df.log=glm(formula = Churn~gender+SeniorCitizen+Dependents+tenure+PhoneService+Contract+TotalCharges,family=poisson(link="log"))
df.log=glm(formula = Churn~gender+SeniorCitizen+Dependents+tenure+PhoneService+Contract+TotalCharges,family=poisson(link="log"),data=df)
summary(df.log)
library(MASS)
step.fit5 <- stepAIC(df.log,direction = "both")
summary(step.fit5)
mydata <- read.csv("https://stats.idre.ucla.edu/stat/data/binary.csv")
library(aod)
library(ggplot2)
xtabs(~admit + rank, data = mydata)
mydata$rank <- factor(mydata$rank)
mypossion<- glm(admit ~ gre + gpa + rank, data = mydata, family = poisson(link="log"))
mypossion
mydata$rank=as.factor(mydata$rank)
logit=glm(admit~gre+gpa+rank,family=binomial(link="logit"),data=mydata)
summary(logit)
library(MASS)
step.fit2 <- stepAIC(logit,direction = "both")
summary(step.fit2)
probit=glm(admit~gre+gpa+rank,family=binomial(link="probit"),data=mydata)
summary(probit)
library(MASS)
step.fit3 <- stepAIC(probit,direction = "both")
summary(step.fit3)
df.log=glm(admit~gre+gpa+rank,family=poisson(link="logit"),data=mydata)
summary(df.log)
library(MASS)
step.fit4 <- stepAIC(df.log,direction = "both")
summary(step.fit4)
df.log=glm(admit~gre+gpa+rank,family=poisson(link="logit"),data=mydata)
summary(df.log)
library(MASS)
step.fit4 <- stepAIC(df.log,direction = "both")
summary(step.fit4)
mydata$rank=as.factor(mydata$rank)
df.log=glm(admit~gre+gpa+rank,family=poisson(link="logit"),data=mydata)
summary(df.log)
library(MASS)
step.fit4 <- stepAIC(df.log,direction = "both")
summary(step.fit4)
mydata
mydata$rank=as.factor(mydata$rank)
df.log=glm(admit~gre+gpa+rank,family=poisson(link="logit"),data=mydata)
summary(df.log)
library(MASS)
step.fit4 <- stepAIC(df.log,direction = "both")
summary(step.fit4)
mydata$rank=as.factor(mydata$rank)
log=glm(admit~gre+gpa+rank,family=poisson(link="logit"),data=mydata)
summary(log)
library(MASS)
step.fit4 <- stepAIC(log,direction = "both")
summary(step.fit4)
mydata$rank=as.factor(mydata$rank)
mydata$rank=as.factor(mydata$rank)
log=glm(admit~gre+gpa+rank,family=poisson(link="log"),data=mydata)
summary(log)
library(MASS)
step.fit4 <- stepAIC(log,direction = "both")
summary(step.fit4)
load("D:/火狐下载/assignment3Q1Data.RData")
load("D:/火狐下载/assignment3Q2Data.RData")
survdiff(Surv(machinedata$run.time,machinedata$status)~machinedata$type)
View(mydata)
mydata=read.csv(file.choose(),header=T)
Sys.which("make")
version
load("~/.Rhistory")
load("C:/Users/p9300/Desktop/222.RData")
var<-colnames(d)
nonormal <- c("age", "creatinine_phosphokinase", "ejection_fraction","platelets", "serum_creatinine" ,
"serum_sodium" ,"time")
quantile(d$time)
quantile(d$time)
d$timegroup[d$time<=73]='Q1'
d$timegroup[d$time>73 & d$time<=115] <- 'Q2'
d$timegroup[d$time>115 & d$time<=203] <- 'Q3'
d$timegroup[d$time>203] <- 'Q4'
d$timegroup
table_one<-CreateTableOne(vars = var,
strata = 'timegroup',
data=d)
install.packages('tableone')
library(tableone)
table_one<-CreateTableOne(vars = var,
strata = 'timegroup',
data=d)
tab1Mat <- print(table_one,
quote = FALSE,
nonnormal = nonormal,
noSpaces = TRUE,
printToggle = FALSE)
setwd('C:/Users/p9300/Desktop/heartfailure/')
write.csv(tab1Mat, file = "myTable.csv")
setwd('C:/Users/p9300/Desktop/heartfailure/')
write.csv(tab1Mat, file = "myTable.csv")
table_one
save.image("C:/Users/p9300/Desktop/heartfailure/history.RData")
